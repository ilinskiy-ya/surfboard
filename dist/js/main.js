const findBlockByAlias=o=>$(".reviews__item").filter((e,t)=>$(t).attr("data-linked-with")===o);$(".interactive-avatar__link").click(e=>{e.preventDefault();const t=$(e.currentTarget);e=t.attr("data-open");const o=findBlockByAlias(e),n=t.closest(".reviews__switcher-item");o.addClass("active").siblings().removeClass("active"),n.addClass("interactive-avatar--active").siblings().removeClass("interactive-avatar--active")});const openItem=e=>{const t=e.closest(".team__item"),o=t.find(".team__content"),n=o.find(".team__content-block");e=n.height();t.addClass("active"),o.height(e)},closeEveryItem=e=>{const t=e.find(".team__content"),o=e.find(".team__item");o.removeClass("active"),t.height(0)};$(".team__title").click(e=>{const t=$(e.currentTarget);e=t.closest(".team");const o=t.closest(".team__item");o.hasClass("active")?closeEveryItem(e):(closeEveryItem(e),openItem(t))});const slider=$(".products").bxSlider({pager:!1,controls:!1});$(".arrow__left").click(e=>{e.preventDefault(),slider.goToPrevSlide()}),$(".arrow__right").click(e=>{e.preventDefault(),slider.goToNextSlide()});const modal=$(".order__background");$(".form").submit(e=>{e.preventDefault();const t=$(e.currentTarget),o=t.find('[name="name"]'),n=t.find('[name="phone"]'),s=t.find('[name="street"]'),i=t.find('[name="house"]'),c=t.find('[name="flat"]');[o,n,s,i,c].forEach(e=>{e.removeClass("input-error"),""==e.val().trim()&&e.addClass("input-error")});e=t.find("input-error");console.log(e),0==e.length&&$.ajax({URL:"https://webdev-api.loftschool.com/sendmail",method:"post",data:{name:o.val(),phone:n.val(),comment:s.val(),house:i.val(),flat:c.val(),to:"test@test.ru"},success:e=>{modal.addClass("order__background_active")},error:e=>{modal.addClass("order__background_active")}})}),$(".button__close").click(e=>{e.preventDefault(),modal.removeClass("order__background_active")});let myMap;const init=()=>{myMap=new ymaps.Map("map",{center:[54.73,20.51],zoom:16})};ymaps.ready(init);const sections=$("section"),display=$(".maincontent"),sideMenu=$(".fixed-menu"),menuItens=sideMenu.find(".fixed-menu__item");let inScroll=!1;sections.first().addClass("active");const countSectionPosition=e=>{e*=-100;return isNaN(e)?(console.error("передано не верное значение в countSectionPosition"),0):e},chandgeMenuThemeForSection=e=>{const t=sections.eq(e);e="fixed-menu--shadowed";"black"==t.attr("data-sidemenu-theme")?sideMenu.addClass(e):sideMenu.removeClass(e)},performTransition=e=>{if(!inScroll){inScroll=!0;var t=countSectionPosition(e);chandgeMenuThemeForSection(e),display.css({transform:`translateY(${t}%)`});const o=(e,t,o)=>{e.eq(t).addClass(o).siblings().removeClass(o)};o(sections,e,"active"),sections.eq(e).addClass("active").siblings().removeClass("active"),setTimeout(()=>{inScroll=!1,o(menuItens,e,"fixed-menu__item--active")},1300)}},viewportScroller=()=>{const e=sections.filter(".active"),t=e.next(),o=e.prev();return{next(){t.length&&performTransition(t.index())},prev(){o.length&&performTransition(o.index())}}};$(window).on("wheel",e=>{e=e.originalEvent.deltaY;const t=viewportScroller();0<e&&t.next(),e<0&&t.prev()}),$(window).on("keydown",e=>{var t=e.target.tagName.toLowerCase(),t="input"==t||"textarea"==t;const o=viewportScroller();if(!t)switch(e.keyCode){case 38:o("prev");break;case 40:o("next")}}),$("[data-scroll-to]").click(e=>{e.preventDefault();const t=$(e.currentTarget);e=t.attr("data-scroll-to");const o=$(`[data-section-id=${e}]`);performTransition(o.index())}),$("wrapper").swipe({swipe:function(e,t){const o=viewportScroller();let n="down"==t?"prev":"up"==t?"next":"";o[n]()}});const popupLinks=document.querySelectorAll(".popup-link"),body=document.querySelector("body"),lockPadding=document.querySelectorAll(".lock-padding");let unlock=!0;const timeout=800;if(0<popupLinks.length)for(let e=0;e<popupLinks.length;e++){const oa=popupLinks[e];oa.addEventListener("click",function(e){var t=oa.getAttribute("href").replace("#","");popupOpen(document.getElementById(t)),e.preventDefault()})}const popupCloseIcon=document.querySelectorAll(".close-popup");if(0<popupCloseIcon.length)for(let e=0;e<popupCloseIcon.length;e++){const ta=popupCloseIcon[e];ta.addEventListener("click",function(e){popupClose(ta.closest(".popup")),e.preventDefault()})}function popupOpen(e){var t;e&&unlock&&((t=document.querySelector(".popup.open"))?popupClose(t,!1):bodyLock(),e.classList.add("open"),e.addEventListener("click",function(e){e.target.closest(".popup__content")||popupClose(e.target.closest(".popup"))}))}function popupClose(e,t=!0){unlock&&(e.classList.remove("open"),t&&bodyUnLock())}function bodyLock(){var t=window.innerWidth-document.querySelector(".wrapper").offsetWidth+"px";if(0<lockPadding.length)for(let e=0;e<lockPadding.length;e++){const o=lockPadding[e];o.style.paddingRight=t}body.style.paddingRight=t,body.classList.add("lock"),unlock=!1,setTimeout(function(){unlock=!0},timeout)}function bodyUnLock(){setTimeout(function(){if(0<lockPadding.length)for(let e=0;e<lockPadding.length;e++){const t=lockPadding[e];t.style.paddingRight="0px"}body.style.paddingRight="0px",body.classList.remove("lock")},timeout),unlock=!1,setTimeout(function(){unlock=!0},timeout)}document.addEventListener("keydown",function(e){27===e.which&&popupClose(document.querySelector(".popup.open"))}),Element.prototype.closest||(Element.prototype.closest=function(e){for(var t=this;t;){if(t.matches(e))return t;t=t.parentElement}return null}),Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJwb3B1cHMuanMiXSwibmFtZXMiOlsiZmluZEJsb2NrQnlBbGlhcyIsIiQiLCJmaWx0ZXIiLCJuZHgiLCJpdGVtIiwiYXR0ciIsImFsaWFzIiwiY2xpY2siLCJlIiwicHJldmVudERlZmF1bHQiLCIkdGhpcyIsImN1cnJlbnRUYXJnZXQiLCJ0YXJnZXQiLCJpdGVtVG9TaG93IiwiY3VySXRlbSIsImNsb3Nlc3QiLCJhZGRDbGFzcyIsInNpYmxpbmdzIiwicmVtb3ZlQ2xhc3MiLCJvcGVuSXRlbSIsImNvbnRhaW5lciIsImNvbnRlbnRCbG9jayIsImZpbmQiLCJ0ZXh0QmxvY2siLCJyZXFIZWlnaHQiLCJoZWlnaHQiLCJjbG9zZUV2ZXJ5SXRlbSIsIml0ZW1zIiwiaXRlbUNvbnRhaW5lciIsImVsZW1Db250YWluZXIiLCJoYXNDbGFzcyIsInNsaWRlciIsImJ4U2xpZGVyIiwicGFnZXIiLCJjb250cm9scyIsImdvVG9QcmV2U2xpZGUiLCJnb1RvTmV4dFNsaWRlIiwibW9kYWwiLCJzdWJtaXQiLCJmb3JtIiwibmFtZSIsInBob25lIiwic3RyZWV0IiwiaG91c2UiLCJmbGF0IiwiZm9yRWFjaCIsImZpbGVkIiwidmFsIiwidHJpbSIsImVycm9yRmllbGRzIiwiY29uc29sZSIsImxvZyIsImxlbmd0aCIsImFqYXgiLCJVUkwiLCJtZXRob2QiLCJkYXRhIiwiY29tbWVudCIsInRvIiwic3VjY2VzcyIsImVycm9yIiwibXlNYXAiLCJpbml0IiwieW1hcHMiLCJNYXAiLCJjZW50ZXIiLCJ6b29tIiwicmVhZHkiLCJzZWN0aW9ucyIsImRpc3BsYXkiLCJzaWRlTWVudSIsIm1lbnVJdGVucyIsImluU2Nyb2xsIiwiZmlyc3QiLCJjb3VudFNlY3Rpb25Qb3NpdGlvbiIsInBvc2l0aW9uIiwiaXNOYU4iLCJjaGFuZGdlTWVudVRoZW1lRm9yU2VjdGlvbiIsImN1cnJlbnRTZWN0aW9uIiwiZXEiLCJzZWN0aW9uRXEiLCJhY3RpdmVDbGFzcyIsInBlcmZvcm1UcmFuc2l0aW9uIiwiY3NzIiwidHJhbnNmb3JtIiwicmVzZXRBY3RpdmVDbGFzc0Zvckl0ZW0iLCJpdGVtRXEiLCJzZXRUaW1lb3V0IiwidHJhbnNpdGlvbk92ZXIiLCJ2aWV3cG9ydFNjcm9sbGVyIiwiYWN0aXZlU2VjdGlvbiIsIm5leHRTZWN0aW9uIiwibmV4dCIsInByZXZTZWN0aW9uIiwicHJldiIsImluZGV4Iiwid2luZG93Iiwib24iLCJkZWx0YVkiLCJvcmlnaW5hbEV2ZW50Iiwic2Nyb2xsZXIiLCJ0YWdOYW1lIiwidG9Mb3dlckNhc2UiLCJ1c2VyVHVwaW5nSW5wdXRzIiwia2V5Q29kZSIsInJlcVNlY3Rpb24iLCJzd2lwZSIsImV2ZW50IiwiZGlyZWN0aW9uIiwic2Nyb2xsRGlyZWN0aW9uIiwicG9wdXBMaW5rcyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImJvZHkiLCJxdWVyeVNlbGVjdG9yIiwibG9ja1BhZGRpbmciLCJ1bmxvY2siLCJ0aW1lb3V0IiwicG9wdXBMaW5rIiwiYWRkRXZlbnRMaXN0ZW5lciIsInBvcHVwTmFtZSIsImdldEF0dHJpYnV0ZSIsInJlcGxhY2UiLCJwb3B1cE9wZW4iLCJnZXRFbGVtZW50QnlJZCIsInBvcHVwQ2xvc2VJY29uIiwiZWwiLCJwb3B1cENsb3NlIiwiY3VyZW50UG9wdXAiLCJwb3B1cEFjdGl2ZSIsImJvZHlMb2NrIiwiY2xhc3NMaXN0IiwiYWRkIiwiZG9VbmxvY2siLCJyZW1vdmUiLCJib2R5VW5Mb2NrIiwibG9ja1BhZGRpbmdWYWx1ZSIsImlubmVyV2lkdGgiLCJvZmZzZXRXaWR0aCIsInN0eWxlIiwicGFkZGluZ1JpZ2h0Iiwid2hpY2giLCJFbGVtZW50IiwicHJvdG90eXBlIiwibm9kZSIsInRoaXMiLCJtYXRjaGVzIiwicGFyZW50RWxlbWVudCIsIm1hdGNoZXNTZWxlY3RvciIsIndlYmtpdE1hdGNoZXNTZWxlY3RvciIsIm1vek1hdGNoZXNTZWxlY3RvciIsIm1zTWF0Y2hlc1NlbGVjdG9yIl0sIm1hcHBpbmdzIjoi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QUNBRCxHQUFBLENBQ0EsR0FBQUEsRUFBQUUsUUFBQS9ELEdBQUEsT0FBQTZELEVBQ0FBLEVBQUFBLEVBQUFHLGNBRUEsT0FBQSxPQU1BTCxRQUFBQyxVQUFBRyxVQUVBSixRQUFBQyxVQUFBRyxRQUFBSixRQUFBQyxVQUFBSyxpQkFDQU4sUUFBQUMsVUFBQU0sdUJBQ0FQLFFBQUFDLFVBQUFPLG9CQUNBUixRQUFBQyxVQUFBUSIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy/QvtGC0LfRi9Cy0YtcclxuY29uc3QgZmluZEJsb2NrQnlBbGlhcyA9IChhbGlhcykgPT4ge1xyXG4gICByZXR1cm4gJChcIi5yZXZpZXdzX19pdGVtXCIpLmZpbHRlcigobmR4LCBpdGVtKT0+e1xyXG4gICAgICAgcmV0dXJuICQoaXRlbSkuYXR0cihcImRhdGEtbGlua2VkLXdpdGhcIikgPT09IGFsaWFzXHJcbiAgICB9ICk7XHJcbn07XHJcblxyXG4kKCcuaW50ZXJhY3RpdmUtYXZhdGFyX19saW5rJykuY2xpY2soZSA9PntcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICBjb25zdCAkdGhpcyA9JChlLmN1cnJlbnRUYXJnZXQpO1xyXG4gICAgY29uc3QgdGFyZ2V0PSAkdGhpcy5hdHRyIChcImRhdGEtb3BlblwiKTtcclxuICAgIGNvbnN0IGl0ZW1Ub1Nob3cgPSBmaW5kQmxvY2tCeUFsaWFzKHRhcmdldCk7XHJcbiAgICBjb25zdCBjdXJJdGVtID0kdGhpcy5jbG9zZXN0KCcucmV2aWV3c19fc3dpdGNoZXItaXRlbScpO1xyXG5cclxuICAgIGl0ZW1Ub1Nob3cuYWRkQ2xhc3MoJ2FjdGl2ZScpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgICBjdXJJdGVtLmFkZENsYXNzKCdpbnRlcmFjdGl2ZS1hdmF0YXItLWFjdGl2ZScpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoJ2ludGVyYWN0aXZlLWF2YXRhci0tYWN0aXZlJyk7XHJcblxyXG59KTtcclxuXHJcbi8vaW50ZXJhY3RpdmUtYXZhdGFyX19saW5rIFxyXG5cclxuLy/QutC+0LzQsNC90LDQtNCwXHJcblxyXG5jb25zdCBvcGVuSXRlbSA9IGl0ZW0gPT4ge1xyXG4gICAgY29uc3QgY29udGFpbmVyID0gaXRlbS5jbG9zZXN0KFwiLnRlYW1fX2l0ZW1cIik7XHJcbiAgICBjb25zdCBjb250ZW50QmxvY2sgPSBjb250YWluZXIuZmluZChcIi50ZWFtX19jb250ZW50XCIpO1xyXG4gICAgY29uc3QgdGV4dEJsb2NrID0gY29udGVudEJsb2NrLmZpbmQoXCIudGVhbV9fY29udGVudC1ibG9ja1wiKTtcclxuICAgIGNvbnN0IHJlcUhlaWdodCA9IHRleHRCbG9jay5oZWlnaHQoKTtcclxuXHJcbiAgICBjb250YWluZXIuYWRkQ2xhc3MoXCJhY3RpdmVcIilcclxuICAgIGNvbnRlbnRCbG9jay5oZWlnaHQocmVxSGVpZ2h0KTtcclxufVxyXG5cclxuY29uc3QgY2xvc2VFdmVyeUl0ZW0gPSBjb250YWluZXIgPT4ge1xyXG4gICAgY29uc3QgaXRlbXMgPSBjb250YWluZXIuZmluZCgnLnRlYW1fX2NvbnRlbnQnKTtcclxuICAgIGNvbnN0IGl0ZW1Db250YWluZXIgPSBjb250YWluZXIuZmluZChcIi50ZWFtX19pdGVtXCIpO1xyXG5cclxuICAgIGl0ZW1Db250YWluZXIucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgICBpdGVtcy5oZWlnaHQoMCk7IFxyXG59XHJcblxyXG4kKFwiLnRlYW1fX3RpdGxlXCIpLmNsaWNrKGUgPT4ge1xyXG4gICAgY29uc3QgJHRoaXMgPSAkKGUuY3VycmVudFRhcmdldCk7XHJcbiAgICBjb25zdCBjb250YWluZXIgPSAkdGhpcy5jbG9zZXN0KFwiLnRlYW1cIik7XHJcbiAgICBjb25zdCBlbGVtQ29udGFpbmVyID0gJHRoaXMuY2xvc2VzdChcIi50ZWFtX19pdGVtXCIpO1xyXG4gXHJcbiAgICBpZihlbGVtQ29udGFpbmVyLmhhc0NsYXNzKFwiYWN0aXZlXCIpKSB7XHJcbiAgICBjbG9zZUV2ZXJ5SXRlbShjb250YWluZXIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgIGNsb3NlRXZlcnlJdGVtKGNvbnRhaW5lcik7XHJcbiAgICBvcGVuSXRlbSgkdGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgXHJcbn0pO1xyXG5cclxuLy/RgdC70LDQudC00LXRgFxyXG5cclxuY29uc3Qgc2xpZGVyPSAkKCcucHJvZHVjdHMnKS5ieFNsaWRlcih7XHJcbiAgICBwYWdlcjogZmFsc2UsXHJcbiAgICBjb250cm9sczogZmFsc2VcclxufSk7XHJcblxyXG4kKFwiLmFycm93X19sZWZ0XCIpLmNsaWNrKGUgPT57XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgc2xpZGVyLmdvVG9QcmV2U2xpZGUoKTtcclxufSlcclxuXHJcbiQoXCIuYXJyb3dfX3JpZ2h0XCIpLmNsaWNrKGUgPT57XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgc2xpZGVyLmdvVG9OZXh0U2xpZGUoKTtcclxufSlcclxuXHJcblxyXG4vL9C30LDQutCw0LfRiyBwb3B1cFxyXG4gICAgY29uc3QgbW9kYWwgPSAkKFwiLm9yZGVyX19iYWNrZ3JvdW5kXCIpO1xyXG4kKFwiLmZvcm1cIikuc3VibWl0IChlID0+e1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgIFxyXG4gICAgY29uc3QgZm9ybSA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcclxuICAgIGNvbnN0IG5hbWUgPSBmb3JtLmZpbmQoJ1tuYW1lPVwibmFtZVwiXScpO1xyXG4gICAgY29uc3QgcGhvbmUgPSBmb3JtLmZpbmQoJ1tuYW1lPVwicGhvbmVcIl0nKTtcclxuICAgIGNvbnN0IHN0cmVldCA9IGZvcm0uZmluZCgnW25hbWU9XCJzdHJlZXRcIl0nKTtcclxuICAgIGNvbnN0IGhvdXNlID0gZm9ybS5maW5kKCdbbmFtZT1cImhvdXNlXCJdJyk7XHJcbiAgICBjb25zdCBmbGF0ID0gZm9ybS5maW5kKCdbbmFtZT1cImZsYXRcIl0nKTtcclxuICAvLyAgY29uc3QgdG8gPSBmb3JtLmZpbmQoJ1tuYW1lPVwidG9cIl0nKTtcclxuXHJcbiAgICBbbmFtZSwgcGhvbmUsIHN0cmVldCwgaG91c2UsIGZsYXRdLmZvckVhY2goKGZpbGVkKSA9PntcclxuICAgICAgICBmaWxlZC5yZW1vdmVDbGFzcyhcImlucHV0LWVycm9yXCIpO1xyXG4gICAgICAgIGlmKGZpbGVkLnZhbCgpLnRyaW0oKSA9PVwiXCIpe1xyXG4gICAgICAgICAgICBmaWxlZC5hZGRDbGFzcyhcImlucHV0LWVycm9yXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGNvbnN0IGVycm9yRmllbGRzID0gZm9ybS5maW5kKFwiaW5wdXQtZXJyb3JcIik7XHJcbiAgICBjb25zb2xlLmxvZyhlcnJvckZpZWxkcyk7XHJcblxyXG4gICAgaWYgKGVycm9yRmllbGRzLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgVVJMOiBcImh0dHBzOi8vd2ViZGV2LWFwaS5sb2Z0c2Nob29sLmNvbS9zZW5kbWFpbFwiLFxyXG4gICAgICAgICAgICBtZXRob2Q6IFwicG9zdFwiLFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBuYW1lLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgcGhvbmU6IHBob25lLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgY29tbWVudDogc3RyZWV0LnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgaG91c2U6IGhvdXNlLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgZmxhdDogZmxhdC52YWwoKSxcclxuICAgICAgICAgICAgICAgIHRvOiBcInRlc3RAdGVzdC5ydVwiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGRhdGEgPT4ge1xyXG4gICAgICAgICAgLy8gICAgICBtb2RhbFRleHQudGV4dChkYXRhLm1lc3NhZ2UpXHJcbiAgICAgICAgICAgICAgICAgIG1vZGFsLmFkZENsYXNzKFwib3JkZXJfX2JhY2tncm91bmRfYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgZXJyb3I6IGRhdGEgPT57XHJcbiAgICAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgICAgICAvLyAgICBjb25zdCBFcnJNZXNzYWdlID0gZGF0YS5yZXNwb25zZUpTT04ubWVzc2FnZTtcclxuICAgICAgICAgICAgICAvLyAgbW9kYWxUZXh0LnRleHQoRXJyTWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgLy8gICQobW9kYWxUZXh0KS5jc3MoXCJjb2xvclwiLCBcInJlZFwiKTtcclxuICAgICAgICAgICAgICAgIG1vZGFsLmFkZENsYXNzKFwib3JkZXJfX2JhY2tncm91bmRfYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgXHJcblxyXG4gICAgLyokLmZhbmN5Ym94Lm9wZW4oe1xyXG4gICAgICAgIHNyYzogXCIjcG9wdXBcIixcclxuICAgICAgICB0eXBlOiBcImlubGluZVwiXHJcbiAgICB9KSovXHJcbiAgICBcclxufSk7XHJcblxyXG4kKFwiLmJ1dHRvbl9fY2xvc2VcIikuY2xpY2soZSA9PntcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICBtb2RhbC5yZW1vdmVDbGFzcyhcIm9yZGVyX19iYWNrZ3JvdW5kX2FjdGl2ZVwiKTtcclxufSk7XHJcblxyXG4vL9C60LDRgNGC0LBcclxuXHJcbi8qeW1hcHMucmVhZHkoaW5pdCk7XHJcbmZ1bmN0aW9uIGluaXQoKXtcclxuICAgIHZhciBteU1hcCA9IG5ldyB5bWFwcy5NYXAoXCJtYXBcIiwge1xyXG4gICAgICAgIGNlbnRlcjogWzU1Ljc2LCAzNy42NF0sXHJcbiAgICAgICAgem9vbTogN1xyXG4gICAgfSk7XHJcbn0qL1xyXG5cclxubGV0IG15TWFwO1xyXG5cclxuY29uc3QgaW5pdCA9ICgpID0+IHtcclxuICAgIG15TWFwID0gbmV3IHltYXBzLk1hcChcIm1hcFwiLHtcclxuICAgICAgICBjZW50ZXI6IFs1NC43MywgMjAuNTFdLFxyXG4gICAgICAgIHpvb206IDE2XHJcbiAgICB9KTtcclxufVxyXG5cclxueW1hcHMucmVhZHkoaW5pdCk7XHJcblxyXG4vL09QQ1xyXG5cclxuY29uc3Qgc2VjdGlvbnMgPSAkKCdzZWN0aW9uJyk7XHJcbmNvbnN0IGRpc3BsYXkgPSAkKFwiLm1haW5jb250ZW50XCIpO1xyXG5jb25zdCBzaWRlTWVudSA9ICQoXCIuZml4ZWQtbWVudVwiKTtcclxuY29uc3QgbWVudUl0ZW5zID0gc2lkZU1lbnUuZmluZChcIi5maXhlZC1tZW51X19pdGVtXCIpO1xyXG5cclxubGV0IGluU2Nyb2xsID0gZmFsc2U7XHJcblxyXG5zZWN0aW9ucy5maXJzdCgpLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xyXG5cclxuY29uc3QgY291bnRTZWN0aW9uUG9zaXRpb24gPSAoc2VjdGlvbkVxKSA9PiB7XHJcbiAgICBjb25zdCBwb3NpdGlvbiA9IHNlY3Rpb25FcSAqIC0xMDA7XHJcblxyXG4gICAgaWYgKGlzTmFOKHBvc2l0aW9uKSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCLQv9C10YDQtdC00LDQvdC+INC90LUg0LLQtdGA0L3QvtC1INC30L3QsNGH0LXQvdC40LUg0LIgY291bnRTZWN0aW9uUG9zaXRpb25cIik7XHJcbiAgICAgICAgcmV0dXJuIDA7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHBvc2l0aW9uXHJcbn07XHJcblxyXG5jb25zdCBjaGFuZGdlTWVudVRoZW1lRm9yU2VjdGlvbiA9IChzZWN0aW9uRXEpID0+IHtcclxuICAgIGNvbnN0IGN1cnJlbnRTZWN0aW9uID0gc2VjdGlvbnMuZXEoc2VjdGlvbkVxKTtcclxuICAgIGNvbnN0IG1lbnVUaGVtZSA9IGN1cnJlbnRTZWN0aW9uLmF0dHIoXCJkYXRhLXNpZGVtZW51LXRoZW1lXCIpOyAgICAgICAgICAgICAgIFxyXG4gICAgY29uc3QgYWN0aXZlQ2xhc3M9IFwiZml4ZWQtbWVudS0tc2hhZG93ZWRcIjtcclxuXHJcbiAgICAgICAgICAgIGlmIChtZW51VGhlbWUgPT0gXCJibGFja1wiKSB7XHJcbiAgICAgICAgICAgICAgICBzaWRlTWVudS5hZGRDbGFzcyhhY3RpdmVDbGFzcyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBzaWRlTWVudS5yZW1vdmVDbGFzcyhhY3RpdmVDbGFzcyk7XHJcbiAgICAgICAgICAgIH1cclxufTtcclxuXHJcbmNvbnN0IHBlcmZvcm1UcmFuc2l0aW9uID0gKHNlY3Rpb25FcSkgPT4ge1xyXG4gICAgaWYoaW5TY3JvbGwpIHJldHVybjtcclxuXHJcbiAgICBjb25zdCB0cmFuc2l0aW9uT3ZlciA9IDEwMDA7XHJcbiAgICBjb25zdCBtb3VzZUluZXJ0aWFsT3ZlciA9IDMwMDtcclxuXHJcblxyXG4gICAgICAgIGluU2Nyb2xsID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgY29uc3QgcG9zaXRpb24gPSBjb3VudFNlY3Rpb25Qb3NpdGlvbiAoc2VjdGlvbkVxKTtcclxuXHJcbiAgICAgICAgY2hhbmRnZU1lbnVUaGVtZUZvclNlY3Rpb24oc2VjdGlvbkVxKTtcclxuXHJcbiAgICAgICAgZGlzcGxheS5jc3MgKHtcclxuICAgICAgICAgICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlWSgke3Bvc2l0aW9ufSUpYFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCByZXNldEFjdGl2ZUNsYXNzRm9ySXRlbSA9IChpdGVtcywgaXRlbUVxLCBhY3RpdmVDbGFzcykgPT4ge1xyXG4gICAgICAgICAgICBpdGVtcy5lcShpdGVtRXEpLmFkZENsYXNzKGFjdGl2ZUNsYXNzKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKGFjdGl2ZUNsYXNzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmVzZXRBY3RpdmVDbGFzc0Zvckl0ZW0oc2VjdGlvbnMsIHNlY3Rpb25FcSwgXCJhY3RpdmVcIik7XHJcbiAgICAgICAgc2VjdGlvbnMuZXEoc2VjdGlvbkVxKS5hZGRDbGFzcyhcImFjdGl2ZVwiKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xyXG5cclxuICAgICAgICBcclxuXHJcbiAgICAgICAgc2V0VGltZW91dCgoKT0+e1xyXG4gICAgICAgICAgICBpblNjcm9sbCA9IGZhbHNlOyAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJlc2V0QWN0aXZlQ2xhc3NGb3JJdGVtIChtZW51SXRlbnMsIHNlY3Rpb25FcSxcImZpeGVkLW1lbnVfX2l0ZW0tLWFjdGl2ZVwiICkgICAgICBcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgfSwgdHJhbnNpdGlvbk92ZXIgKyBtb3VzZUluZXJ0aWFsT3Zlcik7ICAgICAgIFxyXG59O1xyXG5cclxuY29uc3Qgdmlld3BvcnRTY3JvbGxlciA9ICAoKSA9PiB7XHJcbiAgICBjb25zdCBhY3RpdmVTZWN0aW9uID0gc2VjdGlvbnMuZmlsdGVyKFwiLmFjdGl2ZVwiKTtcclxuICAgIGNvbnN0IG5leHRTZWN0aW9uID0gYWN0aXZlU2VjdGlvbi5uZXh0KCk7XHJcbiAgICBjb25zdCBwcmV2U2VjdGlvbiA9IGFjdGl2ZVNlY3Rpb24ucHJldigpO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbmV4dCgpe1xyXG4gICAgICAgICAgICBpZiAobmV4dFNlY3Rpb24ubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBwZXJmb3JtVHJhbnNpdGlvbihuZXh0U2VjdGlvbi5pbmRleCgpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcHJldigpIHtcclxuICAgICAgICAgICAgaWYgKHByZXZTZWN0aW9uLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgcGVyZm9ybVRyYW5zaXRpb24ocHJldlNlY3Rpb24uaW5kZXgoKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgfTsgICAgICBcclxufTtcclxuXHJcbiQod2luZG93KS5vbihcIndoZWVsXCIsIChlKSA9PiB7XHJcbiAgICBjb25zdCBkZWx0YVkgPSBlLm9yaWdpbmFsRXZlbnQuZGVsdGFZO1xyXG4gICAgY29uc3Qgc2Nyb2xsZXIgPSB2aWV3cG9ydFNjcm9sbGVyICgpO1xyXG5cclxuICAgIGlmIChkZWx0YVkgPiAwKSB7XHJcbiAgICAgICAgc2Nyb2xsZXIubmV4dCgpO1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIGlmIChkZWx0YVkgPCAwKSB7ICAgICAgICBcclxuICAgICAgICBzY3JvbGxlci5wcmV2KCk7XHJcbiAgICB9XHJcbiAgICBcclxufSk7XHJcblxyXG4kKHdpbmRvdykub24oXCJrZXlkb3duXCIsIChlKSA9PiB7XHJcbiAgICBjb25zdCB0YWdOYW1lID0gZS50YXJnZXQudGFnTmFtZS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgY29uc3QgdXNlclR1cGluZ0lucHV0cyA9dGFnTmFtZSA9PSBcImlucHV0XCIgfHwgdGFnTmFtZSA9PSAgXCJ0ZXh0YXJlYVwiO1xyXG4gICAgY29uc3Qgc2Nyb2xsZXIgPSB2aWV3cG9ydFNjcm9sbGVyKCk7XHJcblxyXG4gICAgaWYgKHVzZXJUdXBpbmdJbnB1dHMpIHJldHVybjtcclxuXHJcbiAgICAgICAgc3dpdGNoIChlLmtleUNvZGUpIHtcclxuICAgICAgICAgICAgY2FzZSAzODpcclxuICAgICAgICAgICAgc2Nyb2xsZXIgKFwicHJldlwiKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICBcclxuICAgICAgICAgICAgY2FzZSA0MDpcclxuICAgICAgICAgICAgICAgIHNjcm9sbGVyIChcIm5leHRcIik7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9ICAgICAgICBcclxufSk7XHJcblxyXG4kKFwiW2RhdGEtc2Nyb2xsLXRvXVwiKS5jbGljayhlID0+IHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICBjb25zdCAkdGhpcyA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcclxuICAgIGNvbnN0IHRhcmdldCA9ICR0aGlzLmF0dHIoXCJkYXRhLXNjcm9sbC10b1wiKTtcclxuICAgIGNvbnN0IHJlcVNlY3Rpb24gPSAkKGBbZGF0YS1zZWN0aW9uLWlkPSR7dGFyZ2V0fV1gKTtcclxuXHJcbiAgICBwZXJmb3JtVHJhbnNpdGlvbiAocmVxU2VjdGlvbi5pbmRleCgpKTtcclxufSk7XHJcblxyXG5cclxuLy9NT0JJTEVcclxuXHJcbi8vaHR0cHM6Ly9naXRodWIuY29tL21hdHRicnlzb24vVG91Y2hTd2lwZS1KcXVlcnktUGx1Z2luXHJcblxyXG4kKFwid3JhcHBlclwiKS5zd2lwZSh7XHJcbiAgICBzd2lwZTogZnVuY3Rpb24gKGV2ZW50LCBkaXJlY3Rpb24pIHtcclxuICAgICAgICBjb25zdCBzY3JvbGxlciA9IHZpZXdwb3J0U2Nyb2xsZXIoKTtcclxuICAgICAgICBsZXQgc2Nyb2xsRGlyZWN0aW9uID0gXCJcIjtcclxuICAgICAgICBcclxuICAgICAgICBpZiAoZGlyZWN0aW9uID09IFwidXBcIikgc2Nyb2xsRGlyZWN0aW9uID1cIm5leHRcIjtcclxuICAgICAgICBpZiAoZGlyZWN0aW9uID09IFwiZG93blwiKSBzY3JvbGxEaXJlY3Rpb24gPSBcInByZXZcIjtcclxuICAgICAgICBcclxuICAgICAgICBzY3JvbGxlcltzY3JvbGxEaXJlY3Rpb25dKCk7ICAgICBcclxufSxcclxufSk7XHJcblxyXG5cclxuXHJcbi8qXHJcbiQoZnVuY3Rpb24oKSB7XHJcbiAgICAkKFwiYm9keVwiKS5zd2lwZSgge1xyXG4gICAgICAvL0dlbmVyaWMgc3dpcGUgaGFuZGxlciBmb3IgYWxsIGRpcmVjdGlvbnNcclxuICAgICAgc3dpcGU6ZnVuY3Rpb24oZXZlbnQsIGRpcmVjdGlvbiwgZGlzdGFuY2UsIGR1cmF0aW9uLCBmaW5nZXJDb3VudCwgZmluZ2VyRGF0YSkge1xyXG4gICAgICAgICQodGhpcykudGV4dChcIllvdSBzd2lwZWQgXCIgKyBkaXJlY3Rpb24gKTsgIFxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICBcclxuICAgIC8vU2V0IHNvbWUgb3B0aW9ucyBsYXRlclxyXG4gICAgJChcImJvZHlcIikuc3dpcGUoIHtmaW5nZXJzOjJ9ICk7XHJcbiAgfSk7Ki9cclxuIiwiY29uc3QgcG9wdXBMaW5rcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wb3B1cC1saW5rJyk7IC8v0L/QvtC70YPRh9Cw0LXQvCDQstGB0LUg0L/QtdGA0LXQvNC10L3QvdGL0LUg0YEg0LrQu9Cw0YHRgdC+0Lwg0L/QvtC/0LDQv9C70LjQvdC6XHJcbmNvbnN0IGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7IC8v0LHQu9C+0LrQuNGA0YPQtdGCINGB0LrRgNC+0Lsg0LLQvdGD0YLRgNC4INCx0L7QtNC4XHJcbmNvbnN0IGxvY2tQYWRkaW5nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5sb2NrLXBhZGRpbmdcIik7IC8v0L/QvtC70YPRh9Cw0LXRgiDQstGB0LUg0L7QsdGK0LXQutGC0Ysg0YEg0LrQu9Cw0YHRgdC+0Lwg0LvQvtC6INC/0LDQtNC00LjQvdCzXHJcblxyXG5sZXQgdW5sb2NrID0gdHJ1ZTsgLy/Rh9GC0L7QsdGLINC90LUg0LHRi9C70L4g0LTQstC+0LnQvdGL0YUg0L3QsNC20LDRgtC40LlcclxuXHJcbmNvbnN0IHRpbWVvdXQgPSA4MDA7IC8v0LLRi9C70LXQt9Cw0LXRgiDQuNC3INGB0LIt0LLQsCB0cmFuc2l0aW9uINCyIGNzcyDRgdCyLdCy0LAg0LTQvtC70LbQvdGLINCx0YvRgtGMINGA0LDQstC90YtcclxuXHJcbmlmIChwb3B1cExpbmtzLmxlbmd0aCA+IDApIHsgLy/Qv9GA0L7QstC10YDQutCwINGB0YPRidC10YHRgtCy0L7QstCw0L3QuNGPINC30LDQv9GA0LDRiNC40LLQsNC10LzRi9GFINGB0YHRi9C70L7QulxyXG5cdGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBwb3B1cExpbmtzLmxlbmd0aDsgaW5kZXgrKykge1xyXG5cdFx0Y29uc3QgcG9wdXBMaW5rID0gcG9wdXBMaW5rc1tpbmRleF07XHJcblx0XHRwb3B1cExpbmsuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uIChlKSB7IC8v0L/RgNC4INC90LDRhdC+0LbQtNC10L3QuNC4INC90LAg0YHQvtCx0YvRgtC40LUg0LLQtdGI0LDQtdGC0YHRjyDRgdGB0YvQu9C60LBcclxuXHRcdFx0Y29uc3QgcG9wdXBOYW1lID0gcG9wdXBMaW5rLmdldEF0dHJpYnV0ZSgnaHJlZicpLnJlcGxhY2UoJyMnLCAnJyk7IC8v0YEgaHJlZiDRg9Cx0LjRgNCw0LXRgtGB0Y8g0YXRjdGIICjQt9Cw0YfQtdC8PylcclxuXHRcdFx0Y29uc3QgY3VyZW50UG9wdXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChwb3B1cE5hbWUpO1xyXG5cdFx0XHRwb3B1cE9wZW4oY3VyZW50UG9wdXApO1xyXG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7IC8v0LfQv9GA0LXRidCw0LXRgiDQv9C10YDQtdC30LDQs9GA0YPQttCw0YLRjCDRgdGC0YDQsNC90LjRhtGDINC/0L4g0YHRgdGL0LvQutC1XHJcblx0XHR9KTtcclxuXHR9XHJcbn1cclxuY29uc3QgcG9wdXBDbG9zZUljb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2xvc2UtcG9wdXAnKTsgLy/Qt9Cw0LrRgNGL0LLQsNC10YIgcG9wdXBcclxuaWYgKHBvcHVwQ2xvc2VJY29uLmxlbmd0aCA+IDApIHsgLy/Qv9C+0LjRgdC6INC+0LHRitC10LrRgtC+0LIgcG9wdXBDbG9zZUljb25cclxuXHRmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgcG9wdXBDbG9zZUljb24ubGVuZ3RoOyBpbmRleCsrKSB7XHJcblx0XHRjb25zdCBlbCA9IHBvcHVwQ2xvc2VJY29uW2luZGV4XTtcclxuXHRcdGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHsgIC8v0LLQtdGI0LDQtdGC0YHRjyDRgdC+0LHRi9GC0LjQtSBjbGlja1xyXG5cdFx0XHRwb3B1cENsb3NlKGVsLmNsb3Nlc3QoJy5wb3B1cCcpKTsgLy/QstC10YjQsNC10YLRgdGPINC+0LHRitC10LrRgiDRgSDQsdC70LjQttCw0LnRiNC40Lwg0YDQvtC00LjRgtC10LvQtdC8INC4INC60LvQsNGB0YHQvtC8IHBvcHVwXHJcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTsgLy/Qt9C/0YDQtdGJ0LDQtdGCINC/0LXRgNC10LfQsNCz0YDRg9C20LDRgtGMINGB0YLRgNCw0L3QuNGG0YMg0L/QviDRgdGB0YvQu9C60LVcclxuXHRcdH0pO1xyXG5cdH1cclxufVxyXG5cclxuZnVuY3Rpb24gcG9wdXBPcGVuKGN1cmVudFBvcHVwKSB7IC8v0L/QtdGA0LXQtNCw0ZHRgtGB0Y8g0LPQvtGC0L7QstGL0Lkg0L7QsdGK0LXQutGCINC/0L4gaWRcclxuXHRpZiAoY3VyZW50UG9wdXAgJiYgdW5sb2NrKSB7IC8v0L/RgNC40LLQtdGA0LrQsCDQtdGB0YLRjC3Qu9C4INGC0LDQutC+0Lkg0L7QsdGK0LXQutGCINC4INC30LDQv9GA0LXRidCw0LXRgiDQtNCy0L7QudC90L7QtSDQvdCw0LbQsNGC0LjQtVxyXG5cdFx0Y29uc3QgcG9wdXBBY3RpdmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXAub3BlbicpOyAvL9C40YnQtdC8INC+0LHRjNC10LrRgiBwb3B1cCDRgSDQutC70LDRgdGB0L7QvCBvcGVuXHJcblx0XHRpZiAocG9wdXBBY3RpdmUpIHtcclxuXHRcdFx0cG9wdXBDbG9zZShwb3B1cEFjdGl2ZSwgZmFsc2UpOyAvL9C10YHQu9C4INC+0L0g0YHRg9GJ0LXRgtGB0LLRg9C10YIsINGC0L4g0LzRiyDQt9Cw0LrRgNGL0LLQsNC10Lwg0LXQs9C+XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRib2R5TG9jaygpOyAvL9Cx0LvQvtC60LjRgNGD0LUg0YHQutGA0L7QuyDQsiBib2R5XHJcblx0XHR9XHJcblx0XHRjdXJlbnRQb3B1cC5jbGFzc0xpc3QuYWRkKCdvcGVuJyk7IC8v0LogcG9wdXAg0LTQvtCx0LDQstC70Y/QtdGC0YHRjyDQutC70LDRgdGBIG9wZW5cclxuXHRcdGN1cmVudFBvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoZSkge1xyXG5cdFx0XHRpZiAoIWUudGFyZ2V0LmNsb3Nlc3QoJy5wb3B1cF9fY29udGVudCcpKSB7IC8v0LXRgdC70Lgg0YMg0YDQvtC00LjRgtC10LvRjyDQvdC10YIg0LrQu9Cw0YHRgdCwIHBvcHVwX19jb250ZW50INGC0L7Qs9C00LAgcG91cCDQt9Cw0LrRgNGL0LLQsNC10YLRgdGPXHJcblx0XHRcdFx0cG9wdXBDbG9zZShlLnRhcmdldC5jbG9zZXN0KCcucG9wdXAnKSk7IC8v0LXRgdC70Lgg0L3QsNC20LDRgtGMINC90LAg0YLRkdC80L3Rg9GOINC+0LHQu9Cw0YHRgtGMINCy0L3QtSDQutC+0L3RgtC10L3RgtCwLCDRgtC+INGB0YHRi9C70LrQsCDQt9Cw0LrRgNC+0L7QtdGC0YHRj1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHBvcHVwQ2xvc2UocG9wdXBBY3RpdmUsIGRvVW5sb2NrID0gdHJ1ZSkge1xyXG5cdGlmICh1bmxvY2spIHtcclxuXHRcdHBvcHVwQWN0aXZlLmNsYXNzTGlzdC5yZW1vdmUoJ29wZW4nKTtcclxuXHRcdGlmIChkb1VubG9jaykge1xyXG5cdFx0XHRib2R5VW5Mb2NrKCk7XHJcblx0XHR9XHJcblx0fVxyXG59XHJcblxyXG5mdW5jdGlvbiBib2R5TG9jaygpIHsgIC8v0YPQsdC40YDQsNC10YIg0YHQutGA0L7Qu9C7INGB0LvQtdCy0LAg0Lgg0LrQvtC90YLQtdC90YIg0L3QtSDRgdC60LDRh9C10YIg0LrQsNC6INCx0LXRiNC10L3QvdGL0LlcclxuXHRjb25zdCBsb2NrUGFkZGluZ1ZhbHVlID0gd2luZG93LmlubmVyV2lkdGggLSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcud3JhcHBlcicpLm9mZnNldFdpZHRoICsgJ3B4JztcclxuXHJcblx0aWYgKGxvY2tQYWRkaW5nLmxlbmd0aCA+IDApIHsgLy/RgdGC0LDQstC40YIg0L/RgNC+0LLQtdGA0LrRgywg0LXRgdGC0Ywt0LvQuCDRgtCw0LrQuNC1INC+0LHRitC10LrRgtGLXHJcblx0XHRmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgbG9ja1BhZGRpbmcubGVuZ3RoOyBpbmRleCsrKSB7XHJcblx0XHRcdGNvbnN0IGVsID0gbG9ja1BhZGRpbmdbaW5kZXhdO1xyXG5cdFx0XHRlbC5zdHlsZS5wYWRkaW5nUmlnaHQgPSBsb2NrUGFkZGluZ1ZhbHVlO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRib2R5LnN0eWxlLnBhZGRpbmdSaWdodCA9IGxvY2tQYWRkaW5nVmFsdWU7XHJcblx0Ym9keS5jbGFzc0xpc3QuYWRkKCdsb2NrJyk7XHJcblxyXG5cdHVubG9jayA9IGZhbHNlO1xyXG5cdHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG5cdFx0dW5sb2NrID0gdHJ1ZTtcclxuXHR9LCB0aW1lb3V0KTtcclxufVxyXG5cclxuZnVuY3Rpb24gYm9keVVuTG9jaygpIHtcclxuXHRzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuXHRcdGlmIChsb2NrUGFkZGluZy5sZW5ndGggPiAwKSB7XHJcblx0XHRcdGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBsb2NrUGFkZGluZy5sZW5ndGg7IGluZGV4KyspIHtcclxuXHRcdFx0XHRjb25zdCBlbCA9IGxvY2tQYWRkaW5nW2luZGV4XTtcclxuXHRcdFx0XHRlbC5zdHlsZS5wYWRkaW5nUmlnaHQgPSAnMHB4JztcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0Ym9keS5zdHlsZS5wYWRkaW5nUmlnaHQgPSAnMHB4JztcclxuXHRcdGJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnbG9jaycpO1xyXG5cdH0sIHRpbWVvdXQpO1xyXG5cclxuXHR1bmxvY2sgPSBmYWxzZTtcclxuXHRzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuXHRcdHVubG9jayA9IHRydWU7XHJcblx0fSwgdGltZW91dCk7XHJcbn1cclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBmdW5jdGlvbiAoZSkge1xyXG5cdGlmIChlLndoaWNoID09PSAyNykge1xyXG5cdFx0Y29uc3QgcG9wdXBBY3RpdmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXAub3BlbicpO1xyXG5cdFx0cG9wdXBDbG9zZShwb3B1cEFjdGl2ZSk7XHJcblx0fVxyXG59KTtcclxuXHJcbihmdW5jdGlvbiAoKSB7XHJcblx0Ly8g0L/RgNC+0LLQtdGA0Y/QtdC8INC/0L7QtNC00LXRgNC20LrRg1xyXG5cdGlmICghRWxlbWVudC5wcm90b3R5cGUuY2xvc2VzdCkge1xyXG5cdFx0Ly8g0YDQtdCw0LvQuNC30YPQtdC8XHJcblx0XHRFbGVtZW50LnByb3RvdHlwZS5jbG9zZXN0ID0gZnVuY3Rpb24gKGNzcykge1xyXG5cdFx0XHR2YXIgbm9kZSA9IHRoaXM7XHJcblx0XHRcdHdoaWxlIChub2RlKSB7XHJcblx0XHRcdFx0aWYgKG5vZGUubWF0Y2hlcyhjc3MpKSByZXR1cm4gbm9kZTtcclxuXHRcdFx0XHRlbHNlIG5vZGUgPSBub2RlLnBhcmVudEVsZW1lbnQ7XHJcblx0XHRcdH1cclxuXHRcdFx0cmV0dXJuIG51bGw7XHJcblx0XHR9O1xyXG5cdH1cclxufSkoKTtcclxuKGZ1bmN0aW9uICgpIHtcclxuXHQvLyDQv9GA0L7QstC10YDRj9C10Lwg0L/QvtC00LTQtdGA0LbQutGDXHJcblx0aWYgKCFFbGVtZW50LnByb3RvdHlwZS5tYXRjaGVzKSB7XHJcblx0XHQvLyDQvtC/0YDQtdC00LXQu9GP0LXQvCDRgdCy0L7QudGB0YLQstC+XHJcblx0XHRFbGVtZW50LnByb3RvdHlwZS5tYXRjaGVzID0gRWxlbWVudC5wcm90b3R5cGUubWF0Y2hlc1NlbGVjdG9yIHx8XHJcblx0XHRcdEVsZW1lbnQucHJvdG90eXBlLndlYmtpdE1hdGNoZXNTZWxlY3RvciB8fFxyXG5cdFx0XHRFbGVtZW50LnByb3RvdHlwZS5tb3pNYXRjaGVzU2VsZWN0b3IgfHxcclxuXHRcdFx0RWxlbWVudC5wcm90b3R5cGUubXNNYXRjaGVzU2VsZWN0b3I7XHJcblx0fVxyXG59KSgpO1xyXG4iXX0=
